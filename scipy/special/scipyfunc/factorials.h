#include "scipyfunc.h"

static const float factorialsf[] = {
    1.0F,
    1.0F,
    2.0F,
    6.0F,
    24.0F,
    120.0F,
    720.0F,
    5040.0F,
    40320.0F,
    362880.0F,
    3628800.0F,
    39916800.0F,
    4.790016e+08F,
    6.2270208e+09F,
    8.7178289e+10F,
    1.3076744e+12F,
    2.0922791e+13F,
    3.5568741e+14F,
    6.4023735e+15F,
    1.216451e+17F,
    2.432902e+18F,
    5.1090941e+19F,
    1.1240007e+21F,
    2.5852017e+22F,
    6.2044838e+23F,
    1.551121e+25F,
    4.0329146e+26F,
    1.0888869e+28F,
    3.0488835e+29F,
    8.8417619e+30F,
    2.6525285e+32F,
    8.2228384e+33F,
    2.6313083e+35F,
    8.6833179e+36F,
    2.952328e+38F,
};

static const double factorials[] = {
    1.0,
    1.0,
    2.0,
    6.0,
    24.0,
    120.0,
    720.0,
    5040.0,
    40320.0,
    362880.0,
    3628800.0,
    39916800.0,
    479001600.0,
    6227020800.0,
    87178291200.0,
    1307674368000.0,
    20922789888000.0,
    355687428096000.0,
    6402373705728000.0,
    1.21645100408832e+17,
    2.43290200817664e+18,
    5.109094217170944e+19,
    1.1240007277776077e+21,
    2.5852016738884978e+22,
    6.2044840173323941e+23,
    1.5511210043330986e+25,
    4.0329146112660565e+26,
    1.0888869450418352e+28,
    3.0488834461171387e+29,
    8.8417619937397019e+30,
    2.6525285981219107e+32,
    8.2228386541779224e+33,
    2.6313083693369352e+35,
    8.6833176188118859e+36,
    2.9523279903960416e+38,
    1.0333147966386144e+40,
    3.7199332678990118e+41,
    1.3763753091226343e+43,
    5.2302261746660104e+44,
    2.0397882081197442e+46,
    8.1591528324789768e+47,
    3.3452526613163803e+49,
    1.4050061177528798e+51,
    6.0415263063373834e+52,
    2.6582715747884485e+54,
    1.1962222086548019e+56,
    5.5026221598120885e+57,
    2.5862324151116818e+59,
    1.2413915592536073e+61,
    6.0828186403426752e+62,
    3.0414093201713376e+64,
    1.5511187532873822e+66,
    8.0658175170943877e+67,
    4.2748832840600255e+69,
    2.3084369733924138e+71,
    1.2696403353658275e+73,
    7.1099858780486338e+74,
    4.0526919504877214e+76,
    2.3505613312828785e+78,
    1.3868311854568981e+80,
    8.3209871127413899e+81,
    5.0758021387722473e+83,
    3.1469973260387932e+85,
    1.9826083154044399e+87,
    1.2688693218588415e+89,
    8.2476505920824697e+90,
    5.4434493907744295e+92,
    3.6471110918188683e+94,
    2.4800355424368305e+96,
    1.711224524281413e+98,
    1.197857166996989e+100,
    8.504785885678623e+101,
    6.1234458376886085e+103,
    4.4701154615126839e+105,
    3.3078854415193862e+107,
    2.4809140811395396e+109,
    1.8854947016660501e+111,
    1.4518309202828586e+113,
    1.1324281178206297e+115,
    8.9461821307829743e+116,
    7.1569457046263797e+118,
    5.7971260207473678e+120,
    4.7536433370128413e+122,
    3.9455239697206583e+124,
    3.3142401345653532e+126,
    2.8171041143805501e+128,
    2.4227095383672729e+130,
    2.1077572983795275e+132,
    1.8548264225739844e+134,
    1.650795516090846e+136,
    1.4857159644817613e+138,
    1.3520015276784029e+140,
    1.2438414054641305e+142,
    1.1567725070816416e+144,
    1.0873661566567431e+146,
    1.0329978488239058e+148,
    9.9167793487094965e+149,
    9.6192759682482109e+151,
    9.4268904488832465e+153,
    9.3326215443944134e+155,
    9.3326215443944151e+157,

};

static const npy_longdouble factorialsl[] = {
    1.0L,
    1.0L,
    2.0L,
    6.0L,
    24.0L,
    120.0L,
    720.0L,
    5040.0L,
    40320.0L,
    362880.0L,
    3628800.0L,
    39916800.0L,
    479001600.0L,
    6227020800.0L,
    87178291200.0L,
    1307674368000.0L,
    20922789888000.0L,
    355687428096000.0L,
    6402373705728000.0L,
    121645100408832000.0L,
    2432902008176640000.0L,
    51090942171709440000.0L,
    1124000727777607680000.0L,
    25852016738884976640000.0L,
    620448401733239439360000.0L,
    15511210043330985984000000.0L,
    403291461126605635584000000.0L,
    10888869450418352160768000000.0L,
    304888344611713860501504000000.0L,
    8841761993739701954543616000000.0L,
    265252859812191058636308480000000.0L,
    8222838654177922817725562880000000.0L,
    263130836933693530167218012160000000.0L,
    8683317618811886495518194401280000000.0L,
    295232799039604140847618609643520000000.0L,
    1.033314796638614492966665133752320000000e+40L,
    3.719933267899012174679994481508352000000e+41L,
    1.376375309122634504631597958158090240000e+43L,
    5.230226174666011117600072241000742912000e+44L,
    2.039788208119744335864028173990289735680e+46L,
    8.159152832478977343456112695961158942720e+47L,
    3.345252661316380710817006205344075166515e+49L,
    1.405006117752879898543142606244511569936e+51L,
    6.041526306337383563735513206851399750726e+52L,
    2.658271574788448768043625811014615890319e+54L,
    1.196222208654801945619631614956577150643e+56L,
    5.502622159812088949850305428800254892961e+57L,
    2.586232415111681806429643551536119799691e+59L,
    1.241391559253607267086228904737337503852e+61L,
    6.082818640342675608722521633212953768875e+62L,
    3.041409320171337804361260816606476884437e+64L,
    1.551118753287382280224243016469303211063e+66L,
    8.065817517094387857166063685640376697528e+67L,
    4.274883284060025564298013753389399649690e+69L,
    2.308436973392413804720927426830275810832e+71L,
    1.269640335365827592596510084756651695958e+73L,
    7.109985878048634518540456474637249497364e+74L,
    4.052691950487721675568060190543232213498e+76L,
    2.350561331282878571829474910515074683828e+78L,
    1.386831185456898357379390197203894063459e+80L,
    8.320987112741390144276341183223364380754e+81L,
    5.075802138772247988008568121766252272260e+83L,
    3.146997326038793752565312235495076408801e+85L,
    1.982608315404440064116146708361898137544e+87L,
    1.268869321858841641034333893351614808028e+89L,
    8.247650592082470666723170306785496252186e+90L,
    5.443449390774430640037292402478427526442e+92L,
    3.647111091818868528824985909660546442716e+94L,
    2.480035542436830599600990418569171581047e+96L,
    1.711224524281413113724683388812728390922e+98L,
    1.197857166996989179607278372168909873645e+100L,
    8.504785885678623175211676442399260102885e+101L,
    6.123445837688608686152407038527467274077e+103L,
    4.470115461512684340891257138125051110076e+105L,
    3.307885441519386412259530282212537821456e+107L,
    2.480914081139539809194647711659403366092e+109L,
    1.885494701666050254987932260861146558230e+111L,
    1.451830920282858696340707840863082849837e+113L,
    1.132428117820629783145752115873204622873e+115L,
    8.946182130782975286851441715398316520698e+116L,
    7.156945704626380229481153372318653216558e+118L,
    5.797126020747367985879734231578109105412e+120L,
    4.753643337012841748421382069894049466438e+122L,
    3.945523969720658651189747118012061057143e+124L,
    3.314240134565353266999387579130131288000e+126L,
    2.817104114380550276949479442260611594800e+128L,
    2.422709538367273238176552320344125971528e+130L,
    2.107757298379527717213600518699389595229e+132L,
    1.854826422573984391147968456455462843802e+134L,
    1.650795516090846108121691926245361930983e+136L,
    1.485715964481761497309522733620825737885e+138L,
    1.352001527678402962551665687594951421475e+140L,
    1.243841405464130725547532432587355307757e+142L,
    1.156772507081641574759205162306240436214e+144L,
    1.087366156656743080273652852567866010041e+146L,
    1.032997848823905926259970209939472709539e+148L,
    9.916779348709496892095714015418938011581e+149L,
    9.619275968248211985332842594956369871234e+151L,
    9.426890448883247745626185743057242473809e+153L,
    9.332621544394415268169923885626670049071e+155L,
    9.332621544394415268169923885626670049071e+157L,
    9.425947759838359420851623124482936749562e+159L,
    9.614466715035126609268655586972595484553e+161L,
    9.902900716486180407546715254581773349090e+163L,
    1.029901674514562762384858386476504428305e+166L,
    1.081396758240290900504101305800329649720e+168L,
    1.146280563734708354534347384148349428703e+170L,
    1.226520203196137939351751701038733888713e+172L,
    1.324641819451828974499891837121832599810e+174L,
    1.443859583202493582204882102462797533793e+176L,
    1.588245541522742940425370312709077287172e+178L,
    1.762952551090244663872161047107075788761e+180L,
    1.974506857221074023536820372759924883412e+182L,
    2.231192748659813646596607021218715118256e+184L,
    2.543559733472187557120132004189335234812e+186L,
    2.925093693493015690688151804817735520034e+188L,
    3.393108684451898201198256093588573203239e+190L,
    3.969937160808720895401959629498630647790e+192L,
    4.684525849754290656574312362808384164392e+194L,
    5.574585761207605881323431711741977155627e+196L,
    6.689502913449127057588118054090372586752e+198L,
    8.094298525273443739681622845449350829970e+200L,
    9.875044200833601362411579871448208012564e+202L,
    1.214630436702532967576624324188129585545e+205L,
    1.506141741511140879795014161993280686076e+207L,
    1.882677176888926099743767702491600857595e+209L,
    2.372173242880046885677147305139417080570e+211L,
    3.012660018457659544809977077527059692324e+213L,
    3.856204823625804217356770659234636406174e+215L,
    4.974504222477287440390234150412680963965e+217L,
    6.466855489220473672507304395536485253155e+219L,
    8.471580690878820510984568758152795681633e+221L,
    1.118248651196004307449963076076169029975e+224L,
    1.487270706090685728908450891181304809867e+226L,
    1.992942746161518876737324194182948445222e+228L,
    2.690472707318050483595387662146980401050e+230L,
    3.659042881952548657689727220519893345428e+232L,
    5.012888748274991661034926292112253883237e+234L,
    6.917786472619488492228198283114910358867e+236L,
    9.615723196941089004197195613529725398825e+238L,
    1.346201247571752460587607385894161555835e+241L,
    1.898143759076170969428526414110767793728e+243L,
    2.695364137888162776588507508037290267094e+245L,
    3.854370717180072770521565736493325081944e+247L,
    5.550293832739304789551054660550388117999e+249L,
    8.047926057471991944849029257798062771099e+251L,
    1.174997204390910823947958271638517164580e+254L,
    1.727245890454638911203498659308620231933e+256L,
    2.556323917872865588581178015776757943261e+258L,
    3.808922637630569726985955243507369335459e+260L,
    5.713383956445854590478932865261054003189e+262L,
    8.627209774233240431623188626544191544816e+264L,
    1.311335885683452545606724671234717114812e+267L,
    2.006343905095682394778288746989117185662e+269L,
    3.089769613847350887958564670363240465920e+271L,
    4.789142901463393876335775239063022722176e+273L,
    7.471062926282894447083809372938315446595e+275L,
    1.172956879426414428192158071551315525115e+278L,
    1.853271869493734796543609753051078529682e+280L,
    2.946702272495038326504339507351214862194e+282L,
    4.714723635992061322406943211761943779511e+284L,
    7.590705053947218729075178570936729485014e+286L,
    1.229694218739449434110178928491750176572e+289L,
    2.004401576545302577599591653441552787812e+291L,
    3.287218585534296227263330311644146572013e+293L,
    5.423910666131588774984495014212841843821e+295L,
    9.003691705778437366474261723593317460743e+297L,
    1.503616514864999040201201707840084015944e+300L,
    2.526075744973198387538018869171341146786e+302L,
    4.269068009004705274939251888899566538068e+304L,
    7.257415615307998967396728211129263114716e+306L,
};

#define MAX_FACTORIAL  (sizeof(factorials)/sizeof(double))
#define MAX_FACTORIALF (sizeof(factorialsf)/sizeof(float))
#define MAX_FACTORIALL (sizeof(factorialsl)/sizeof(npy_longdouble))
